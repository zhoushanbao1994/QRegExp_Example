# QRegExp_Example
Qt正则表达式例子



[Qt——正则表达式](https://www.cnblogs.com/hellovenus/p/4984751.html)

[正则表达式匹配数字范围](https://geek-docs.com/regexp/regexp-tutorials/regular-expressions-match-numeric-ranges.html)





在项目中经常会遇到对字符串进行操作的情况，我们可以直接使用QString的一些函数，但QT提供了一个更加强大的类——QRegExp，使用正则表达式来操作字符串。

先说说我最近遇到的几个问题：

1. 对输入框LineEdit中的输入内容加以限制，比如只能输入数字，并且最多5位数（因为int类型不限制位数会导致溢出问题）；
2. 检查输入是否正确，比如判断是否是1-9999之间的数；
3. 获取一个字符串中的一段内容，比如获取2015-11-20中的2015。

为了解决这些问题，下面先看看正则表达式的基本知识。



# 一、基本知识

正则表达式（Regular Expression，通常简写为RegExp、RE等），预先定义一些字符或字符的组合，用于匹配文本中的一段字符串。下面是它的一些用途——

1.验证

​	判断字符串是否符合某个标准，比如“是一个整数”或者“没有空格”。

2.搜索

​	正则表达式提供了比普通字符串匹配更为强大的匹配方式，比如匹配下面的词语：mail, letter, correspondence，但是不包括email, mailman, letterbox等等。

3.查找并替换

​	正则表达式能够用一个不同的字符串，替换所有出现另一个字符串的地方，比如用&amp;替换&，如果原先&后面已经有了amp;那么不替换。

4.分割字符串

​	比如，根据tab来分割字符串。

​	使用正则表达式首先需要了解一些符号的作用，比如\d用来匹配数字，下面结合一些例子说明。

| 例子       | 解释                                               |
| ---------- | -------------------------------------------------- |
| `[abc]`    | 方括号中间是几个字母，表示a,b,c这三个单独的字符    |
| `[^abc]`   | 除了a,b,c以外的字符                                |
| `[a-z]`    | 横杠表示范围，匹配a到z之间(包括a和z)的所有单个字符 |
| `[a-zA-Z]` | a到z、A到Z的所有单个字符                           |
| `^`        | 在一行最前                                         |
| `$`        | 在一行的最后                                       |
| `\s`       | 匹配任意空白字符                                   |
| `\S`       | 匹配任意非空白的字符                               |
| `\d`       | 任意数字                                           |
| `\D`       | 任意非数字                                         |
| `\w`       | 任意单字字符（字母、数字或下划线）                 |
| `\W`       | 任意非单字字符                                     |
| `(a|b)`    | a或b                                               |
| `a?`       | ?代表0个或1个                                      |
| `a*`       | *代表0个或1个或多个                                |
| `a+`       | +代表1个或多个                                     |
| `a{3}`     | 3个a                                               |
| `a{3,}`    | 3个或大于3个a                                      |
| `a{3,6}`   | a的个数在3和6之间(包括3和6)                        |

**注意：**C++编译器会对反斜杠进行转换，要想在正则表达式中包括一个\，需要输入两次，例如\\s。要想匹配反斜杠本身，需要输入4次，比如\\\\。

# 二、在QT中的用法

## 1.对用户输入的限制

### void QLineEdit::setValidator(const QValidator * v)

QLineEdit中的这个函数意思是，令LineEidt只接受验证器 v 所匹配的输入，你可以对要输入的内容进行任意的限制。

比如：限制输入框只能输入0到99999

```c++
QRegExp regExp("0|[1-9]\\d{0,4}");
ui.lineEdit->setValidator(new QRegExpValidator(regExp, this));
```

以下一些常用的数字匹配：

| 范围          | 表达式                                                       |
| ------------- | ------------------------------------------------------------ |
| 000..255      | `^([01][0-9][0-9]|2[0-4][0-9]|25[0-5])$`                     |
| 0 or 000..255 | `^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$`                   |
| 0 or 000..127 | `^(0?[0-9]?[0-9]|1[01][0-9]|12[0-7])$`                       |
| 0..999        | `^([0-9]|[1-9][0-9]|[1-9][0-9][0-9])$`                       |
| 000..999      | `^[0-9]{3}$`                                                 |
| 0 or 000..999 | `^[0-9]{1,3}$`                                               |
| 1..999        | `^([1-9]|[1-9][0-9]|[1-9][0-9][0-9])$`                       |
| 001..999      | `^(00[1-9]|0[1-9][0-9]|[1-9][0-9][0-9])$`                    |
| 1 or 001..999 | `^(0{0,2}[1-9]|0?[1-9][0-9]|[1-9][0-9][0-9])$`               |
| 0 or 00..59   | `^[0-5]?[0-9]$`                                              |
| 0 or 000..366 | `^(0?[0-9]?[0-9]|[1-2][0-9][0-9]|3[0-5][0-9]|36[0-6])$`      |
| 正整数        | `^[0-9]*[1-9][0-9]*$`                                        |
| 负整数        | `^-[0-9]*[1-9][0-9]*$`                                       |
| 整数          | `^-?d $`                                                     |
| 浮点数        | `^(-?d )(.d )?$`                                             |
| 正浮点数      | : `^(([0-9] .[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*.[0-9] )|([0-9]*[1-9][0-9]*))$` |
| 复浮点数      | `^(-(([0-9] .[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*.[0-9] )|([0-9]*[1-9][0-9]*)))$` |